
<sw-page class="swag-migration-process-screen">

    <template #smart-bar-header>
        <h2>
            {{ $tc('sw-settings.index.title') }}
            <sw-icon name="small-arrow-medium-right" small></sw-icon>
            {{ $tc('swag-migration.general.mainMenuItemGeneral') }}
        </h2>
    </template>

    <template #smart-bar-actions>

        <sw-button v-if="abortButtonVisible" @click="onAbortButtonClick">
            {{ $tc('swag-migration.index.abortButton') }}
        </sw-button>

        <sw-button v-if="backButtonVisible"
                   variant="primary"
                   @click="onBackButtonClick">
            {{ $tc('swag-migration.index.backButton') }}
        </sw-button>

        <sw-button v-if="pauseButtonVisible"
                   variant="primary"
                   :disabled="pauseButtonDisabled"
                   @click="onPauseButtonClick">
            {{ $tc('swag-migration.index.pauseButton') }}
        </sw-button>

        <sw-button v-if="continueButtonVisible"
                   variant="primary"
                   @click="onContinueButtonClick">
            {{ $tc('swag-migration.index.continueButton') }}
        </sw-button>

        <sw-button-group
                v-if="startButtonVisible"
                :splitButton="true">

            <sw-button variant="primary"
                       :disabled="startButtonDisabled"
                       @click="onStartButtonClick">
                {{ $tc('swag-migration.index.startButton') }}
            </sw-button>

            <sw-context-button :disabled="isLoading">
                <template slot="button">

                    <sw-button square
                               variant="primary"
                               :disabled="isLoading">
                        <sw-icon name="small-arrow-medium-down" size="16"></sw-icon>
                    </sw-button>
                </template>

                <sw-context-menu-item @click="onSaveButtonClick"
                                      :disabled="isLoading">
                    {{ $tc('swag-migration.index.savePremapping.saveButton') }}
                </sw-context-menu-item>
            </sw-context-button>

        </sw-button-group>

    </template>

    <template #content>
        <sw-card-view v-if="!isLoading" class="swag-migration-process-screen">

            <sw-step-display v-if="displayFlowChart && componentIndex !== UI_COMPONENT_INDEX.WARNING_CONFIRM"
                             class="swag-migration-process-screen__step-display"
                             :itemIndex="flowChartItemIndex"
                             :itemVariant="flowChartItemVariant"
                             :initialItemVariants="flowChartInitialItemVariants">
                <sw-step-item>
                    {{ $tc('swag-migration.index.loadingScreenCard.flowChart.premapping') }}
                </sw-step-item>
                <sw-step-item>
                    {{ $tc('swag-migration.index.loadingScreenCard.flowChart.fetchData') }}
                </sw-step-item>
                <sw-step-item>
                    {{ $tc('swag-migration.index.loadingScreenCard.flowChart.writeData') }}
                </sw-step-item>
                <sw-step-item>
                    {{ $tc('swag-migration.index.loadingScreenCard.flowChart.processMedia') }}
                </sw-step-item>
                <sw-step-item disabledIcon="small-default-checkmark-line-medium">
                    {{ $tc('swag-migration.index.loadingScreenCard.flowChart.finish') }}
                </sw-step-item>
            </sw-step-display>

            <swag-migration-confirm-warning v-if="componentIndex === UI_COMPONENT_INDEX.WARNING_CONFIRM"
                                            class="swag-migration-process-screen__confirm-warning"
                                            @confirmation-change="onWarningConfirmationChanged">
            </swag-migration-confirm-warning>

            <swag-migration-premapping v-if="componentIndex === UI_COMPONENT_INDEX.PREMAPPING">
            </swag-migration-premapping>

            <swag-migration-loading-screen
                    v-if="componentIndex === UI_COMPONENT_INDEX.LOADING_SCREEN || componentIndex === UI_COMPONENT_INDEX.PAUSE_SCREEN">
            </swag-migration-loading-screen>

            <swag-migration-media-process v-if="componentIndex === UI_COMPONENT_INDEX.MEDIA_SCREEN">
            </swag-migration-media-process>

            <swag-migration-result-screen v-if="componentIndex === UI_COMPONENT_INDEX.RESULT_SUCCESS"
                                          :runId="runId">
            </swag-migration-result-screen>

            <swag-migration-loading-screen-takeover v-if="componentIndex === UI_COMPONENT_INDEX.TAKEOVER"
                                                    ref="loadingScreenTakeover"
                                                    :isTakeoverForbidden="isTakeoverForbidden"
                                                    :isMigrationInterrupted="isMigrationInterrupted"
                                                    @onTakeoverMigration="onTakeoverMigration"
                                                    @onAbortMigration="onAbortOtherMigration">
            </swag-migration-loading-screen-takeover>

            <swag-migration-loading-screen-connection-lost v-if="componentIndex === UI_COMPONENT_INDEX.CONNECTION_LOST">
            </swag-migration-loading-screen-connection-lost>

            <sw-modal v-if="showAbortMigrationConfirmDialog"
                      class="swag-migration-index-modal-abort-migration-confirm-dialog"
                      :title="$tc('swag-migration.index.confirmAbortDialog.title')"
                      variant="small"
                      @modal-close="onCloseAbortMigrationConfirmDialog">

                <p class="swag-migration-index-modal-abort-migration-confirm-dialog-content">
                    {{ $tc('swag-migration.index.confirmAbortDialog.content') }}
                </p>

                <p class="swag-migration-index-modal-abort-migration-confirm-dialog-hint">
                    {{ $tc('swag-migration.index.confirmAbortDialog.hint') }}
                </p>

                <template #modal-footer>

                    <sw-button size="small" @click="onCloseAbortMigrationConfirmDialog">
                        {{ abortMigrationBackText }}
                    </sw-button>

                    <sw-button variant="primary" size="small" @click="onStop">
                        {{ $tc('swag-migration.index.confirmAbortDialog.confirm') }}
                    </sw-button>
                </template>
            </sw-modal>
        </sw-card-view>
        <sw-loader v-if="isLoading"></sw-loader>
    </template>
</sw-page>
